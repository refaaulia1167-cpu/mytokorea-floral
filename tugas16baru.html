<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Toko Contoh - E-commerce Bootstrap 5</title>
  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body { padding-top: 5rem; }
    .product-card img { object-fit: cover; height: 200px; }
    .badge-sale { position: absolute; right: 0.5rem; top: 0.5rem; }
  </style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
  <div class="container">
    <a class="navbar-brand" href="#">TokoContoh</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMain">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navMain">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link active" href="#">Beranda</a></li>
        <li class="nav-item"><a class="nav-link" href="#products">Produk</a></li>
        <li class="nav-item"><a class="nav-link" href="#about">Tentang</a></li>
         <li class="nav-item"><a class="nav-link" href="#E-Wallet">Pembayaran</a></li>
      </ul>

      <form class="d-flex me-3" id="searchForm">
        <input class="form-control me-2" id="searchInput" type="search" placeholder="Cari produk...">
      </form>

      <button class="btn btn-outline-light position-relative" id="cartBtn" data-bs-toggle="modal" data-bs-target="#cartModal">
        <i class="bi bi-cart"></i> Keranjang <span class="badge bg-danger rounded-pill ms-1" id="cartCount">0</span>
      </button>
    </div>
  </div>
</nav>

<!-- Hero -->
<header class="bg-light py-5">
  <div class="container text-center">
    <h1 class="display-5">Selamat datang di bunga kami</h1>
    <p class="lead">toko rea'flora</p>
    <a href="#products" class="btn btn-primary btn-lg">Lihat Produk</a>
  </div>
</header>

<!-- Products -->
<section id="products" class="py-5">
  <div class="container">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2 class="h4">Produk Populer</h2>
      <div>
        <select id="sortSelect" class="form-select form-select-sm">
          <option value="default">Urutkan: Default</option>
          <option value="price-asc">Harga: Murah → Mahal</option>
          <option value="price-desc">Harga: Mahal → Murah</option>
        </select>
      </div>
    </div>

    <div class="row" id="productGrid">
      <!-- Product cards akan di-render oleh JavaScript -->
    </div>
  </div>
</section>

<!-- About -->
<section id="about" class="py-5 bg-white">
  <div class="container">
    <h3>floral</h3>
    <p>silahkan memilih bunga di toko kami</p>
  </div>
</section>

<!-- Footer -->
<footer class="py-4 bg-dark text-white">
  <div class="container text-center small">&copy; <span id="year"></span> Terimakasih telah berkunjung ke toko rea'</div>
</footer>

<!-- Cart Modal -->
<div class="modal fade" id="cartModal" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Keranjang Belanja</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body" id="cartBody">
        <!-- Isi keranjang di-render oleh JS -->
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">Lanjut Belanja</button>
        <button class="btn btn-success" id="checkoutBtn">Checkout</button>
      </div>
    </div>
  </div>
</div>

<!-- Product Detail Modal -->
<div class="modal fade" id="productModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="productModalLabel">Detail Produk</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-md-6"><img id="modalImage" src="" alt="" class="img-fluid rounded"></div>
          <div class="col-md-6">
            <h4 id="modalName"></h4>
            <p id="modalDesc"></p>
            <h5 id="modalPrice"></h5>
            <div class="mb-3">
              <label>Jumlah</label>
              <input type="number" id="modalQty" class="form-control" value="1" min="1">
            </div>
            <button class="btn btn-primary" id="addFromModal">Tambah ke Keranjang</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Checkout Modal (simple) -->
<div class="modal fade" id="checkoutModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">Form Checkout</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body">
        <form id="checkoutForm">
          <div class="mb-3"><label class="form-label">Nama</label><input class="form-control" required id="custName"></div>
          <div class="mb-3"><label class="form-label">Alamat</label><textarea class="form-control" required id="custAddress"></textarea></div>
          <div class="mb-3"><label class="form-label">Metode Pembayaran</label>
            <select class="form-select" id="paymentMethod"><option>Transfer Bank</option><option>COD</option></select>
          </div>
          <button class="btn btn-success" type="submit">Konfirmasi</button>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
// --- Data produk contoh ---
const products = [
  { id: 1, name: 'buket custom', price: 775000, img: 'buket bungan custom.jpg', desc: 'bisa custom greeting card.' },
  { id: 2, name: 'bunga liliy.', price: 350000, img: 'bunga lily.jpg', desc: 'bisa di jadikan selain buket.' },
  { id: 3, name: 'bunga matahari', price: 220000, img: 'bunga matahari.webp', desc: 'cocok dijadikan hiasan.' },
  { id: 4, name: 'bunga peony.', price: 180000, img: 'bunga peony.jpg', desc: 'untuk hiasan.' },
  { id: 5, name: 'karangan bunga custome', price: 90000, img: 'karangan bunga custom.webp', desc: 'custome bisa buat acara penting' },
  { id: 6, name: 'bunga rose', price: 120000, img: 'bunga merah.jpg', desc: 'dijadikan buket.' }
];

// --- State keranjang ---
let cart = JSON.parse(localStorage.getItem('cartDemo')) || [];

const productGrid = document.getElementById('productGrid');
const cartCount = document.getElementById('cartCount');
const cartBody = document.getElementById('cartBody');
const searchInput = document.getElementById('searchInput');
const sortSelect = document.getElementById('sortSelect');
const yearSpan = document.getElementById('year');

yearSpan.textContent = new Date().getFullYear();

function formatIDR(v){ return 'Rp ' + v.toString().replace(/\B(?=(\d{3})+(?!\d))/g, '.'); }

// Render product cards
function renderProducts(list){
  productGrid.innerHTML = '';
  list.forEach(p => {
    const col = document.createElement('div'); col.className = 'col-12 col-sm-6 col-md-4 mb-4';
    col.innerHTML = `
      <div class="card product-card h-100 position-relative">
        <img src="${p.img}" class="card-img-top" alt="${p.name}">
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">${p.name}</h5>
          <p class="card-text text-muted mb-2">${formatIDR(p.price)}</p>
          <p class="small text-truncate">${p.desc}</p>
          <div class="mt-auto d-flex gap-2">
            <button class="btn btn-sm btn-outline-primary w-100" data-id="${p.id}" onclick="openDetail(${p.id})">Lihat</button>
            <button class="btn btn-sm btn-primary w-100" onclick="addToCart(${p.id},1)"><i class="bi bi-cart-plus"></i> Keranjang</button>
          </div>
        </div>
      </div>`;
    productGrid.appendChild(col);
  });
}

// Initial render
renderProducts(products);
updateCartUI();

// Search
searchInput.addEventListener('input', ()=>{
  const q = searchInput.value.toLowerCase();
  const filtered = products.filter(p => p.name.toLowerCase().includes(q) || p.desc.toLowerCase().includes(q));
  renderProducts(filtered);
});

// Sort
sortSelect.addEventListener('change', ()=>{
  const val = sortSelect.value;
  let sorted = [...products];
  if(val === 'price-asc') sorted.sort((a,b)=>a.price-b.price);
  if(val === 'price-desc') sorted.sort((a,b)=>b.price-a.price);
  renderProducts(sorted);
});

// Open product detail modal
function openDetail(id){
  const p = products.find(x=>x.id===id);
  if(!p) return;
  document.getElementById('modalImage').src = p.img;
  document.getElementById('modalName').textContent = p.name;
  document.getElementById('modalDesc').textContent = p.desc;
  document.getElementById('modalPrice').textContent = formatIDR(p.price);
  document.getElementById('modalQty').value = 1;
  document.getElementById('addFromModal').onclick = ()=>{ addToCart(id, Number(document.getElementById('modalQty').value));
    const modal = bootstrap.Modal.getInstance(document.getElementById('productModal'));
    modal.hide();
  };
  const pm = new bootstrap.Modal(document.getElementById('productModal'));
  pm.show();
}

// Add to cart
function addToCart(id, qty=1){
  const p = products.find(x=>x.id===id); if(!p) return;
  const found = cart.find(i=>i.id===id);
  if(found) found.qty += qty; else cart.push({ id: p.id, name: p.name, price: p.price, qty });
  saveCart();
  updateCartUI();
}

function saveCart(){ localStorage.setItem('cartDemo', JSON.stringify(cart)); }

function updateCartUI(){
  cartCount.textContent = cart.reduce((s,i)=>s+i.qty,0);
  renderCart();
}

// Render cart in modal
function renderCart(){
  if(cart.length===0){ cartBody.innerHTML = '<p class="text-center">Keranjang kosong.</p>'; return; }
  let html = '<div class="list-group">';
  cart.forEach(item=>{
    html += `
      <div class="list-group-item d-flex align-items-center">
        <div class="me-3"><strong>${item.name}</strong><div class="small text-muted">${formatIDR(item.price)}</div></div>
        <div class="ms-auto d-flex align-items-center gap-2">
          <input type="number" min="1" class="form-control form-control-sm" style="width:70px" value="${item.qty}" onchange="changeQty(${item.id}, this.value)">
          <div class="fw-bold ms-3">${formatIDR(item.price * item.qty)}</div>
          <button class="btn btn-sm btn-outline-danger ms-2" onclick="removeItem(${item.id})"><i class="bi bi-trash"></i></button>
        </div>
      </div>`;
  });
  html += '</div>';
  html += `<div class="mt-3 text-end"><h5>Total: ${formatIDR(cart.reduce((s,i)=>s + i.price*i.qty,0))}</h5></div>`;
  cartBody.innerHTML = html;
}

function changeQty(id, val){
  const v = Number(val); if(v<1) return;
  const it = cart.find(x=>x.id===id); if(!it) return; it.qty = v; saveCart(); updateCartUI();
}

function removeItem(id){ cart = cart.filter(i=>i.id!==id); saveCart(); updateCartUI(); }

// Checkout flow
document.getElementById('checkoutBtn').addEventListener('click', ()=>{
  if(cart.length===0){ alert('Keranjang kosong.'); return; }
  const cm = new bootstrap.Modal(document.getElementById('checkoutModal'));
  cm.show();
});

document.getElementById('checkoutForm').addEventListener('submit', (e)=>{
  e.preventDefault();
  // Simulasi konfirmasi
  const name = document.getElementById('custName').value;
  const addr = document.getElementById('custAddress').value;
  const payment = document.getElementById('paymentMethod').value;
  // Dalam aplikasi nyata, kirim data ke backend
  alert(`Terima kasih ${name}! Pesanan Anda diterima. Metode: ${payment}`);
  cart = [];
  saveCart(); updateCartUI();
  const cm = bootstrap.Modal.getInstance(document.getElementById('checkoutModal'));
  cm.hide();
  const cartM = bootstrap.Modal.getInstance(document.getElementById('cartModal'));
  if(cartM) cartM.hide();
});

// Allow opening product modal by global function
window.openDetail = openDetail;
window.addToCart = addToCart;
window.changeQty = changeQty;
window.removeItem = removeItem;

</script>
</body>
</html>
